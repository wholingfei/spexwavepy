============================================================
The speckle-based wavefront sensing techniques
============================================================
*Description goes here...*

.. _prinXSSRefer:

X-ray Speckle Scanning (XSS) technique with reference beam
==========================================================
*Say something here...*

.. _prinXSSSelf:

Self-reference X-ray Speckle Scanning (XSS) technique 
=====================================================
*Say something here...*

.. _prinXSTRefer:

Conventional X-ray Speckle Tracking (XST) technique with reference beam 
=======================================================================
The conventional XST technique with reference beam was developed at the 
early stage of the *in-situ* at-wavelength characterization of the X-ray 
wavefront using speckle pattern **[Add refs]**. 
It is inspired by the popular digital imaging correlation analysis which 
is commonly used in visible light metrology and mechanical 
engineering applications. As the name suggests, 
this technique is used when a reference beam is available. 

If the speckle pattern generated by the incident 
beam without the tested optical element in the 
beam is trackable to the speckle pattern generated by the 
tested optical element, we can call the incident beam as a reference beam. 
Obviously, the reference beam only exist when the tested optical element is planar 
or weak-focusing. Otherwise, the speckle pattern would change dramatically 
that the speckle pattern generated by the tested optical element is not comparable 
to that by the incident beam. 

The following figure shows the experiment 
setup for this technique. 

.. figure:: _static/conXST_principle.png
   :width: 80%
   
   The experiment layout for the conventional X-ray speckle tracking 
   technique with reference beam. 

During the experiment, the tested optical element is moved away from the X-ray 
beam to acquire the reference speckle pattern. Then it is moved in the beam 
to acquire another speckle pattern image. 

Only two images are required for this technique. 
Subregion of the speckle pattern from the sample image is cross-correlated 
with the speckle pattern from the reference image. 
After that, the shift of the speckle pattern in vertical and horizontal directions 
can be acquired. 

The physical quantity directly obtained from this method is the wavefront slope.
We use :math:`ix` and :math:`iy` to represnt the shift in the cooresponding direction. 
The pixel size of the detector, the distance between the diffuser and the detector plane, 
and the wavefront slopes in x and y directions can be represented by :math:`p`, :math:`D`, 
:math:`\alpha_x` and :math:`\alpha_y`, respectively.

The following equations satisfy:

.. math::
   \alpha_x = \frac{\partial W}{\partial x} = \frac{ix \times p}{D}
   
   \alpha_y = \frac{\partial W}{\partial y} = \frac{iy \times p}{D}

Note in the above equations, :math:`\alpha_x` and :math:`\alpha_y` are the slopes, i.e., 
the first derivatives of the wavefront. 


.. _prinXSTSelf:

Self-reference conventional X-ray Speckle Tracking (XST) technique 
==================================================================
No reference beam exists for this type of tracking method. 
As a result, the images to be tracked are both from sample images. 

This technique also requires two images only. 
They are acquired at two different diffuser positions. 

The following figure shows the experiment 
setup for this technique. 

.. figure:: _static/conXST2_principle.png
   :width: 80%
   
   The experiment layout for the self-reference 
   conventional X-ray speckle tracking 
   technique. 

The self-reference conventional XST technique may look ostensibly like the above mentioned 
conventional XST technique with reference beam. 
However, the physical quantities obtained directly from the speckle pattern shifts are 
very much different **[Add refs]**. 

.. _prinXSVTRefer:

X-ray Speckle Vector Tracking (XSVT) technique
==============================================
*Say something here...*

