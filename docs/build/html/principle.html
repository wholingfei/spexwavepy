
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The speckle-based wavefront sensing techniques &#8212; spexwavepy 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting started" href="getstart.html" />
    <link rel="prev" title="spexwavepy" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="getstart.html" title="Getting started"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="spexwavepy"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">spexwavepy 1.0.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">The speckle-based wavefront sensing techniques</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="the-speckle-based-wavefront-sensing-techniques">
<h1>The speckle-based wavefront sensing techniques<a class="headerlink" href="#the-speckle-based-wavefront-sensing-techniques" title="Permalink to this heading"></a></h1>
<p>When shining a laser through a diffuser,
a two-dimensional random intensity (speckle) patterns will be generated.
Speckle-based techniques have long been used in metrology
and other applications that using visible light.
Those visible light techniques have been extended to X-ray regime
a decade ago by early researchers <a class="reference internal" href="#berujonprl" id="id1"><span>[BerujonPRL]</span></a> and <a class="reference internal" href="#morganapl" id="id2"><span>[MorganAPL]</span></a>.
Since then, the X-ray speckle-based techniques was burgeoning over time.
These techniques stand out due to their relatively simple
experimental requirements and ease of use.</p>
<p>A typical experimental setup for hard X-ray is shown in the
following picture. The diffuser used is a sandpaper.
It is mounted on a 2D scannable high precision stage.
The detector used a scintillator to convert the incident
X-ray to the visible light and coupled with a microscopy
imaging system.</p>
<figure class="align-default" id="id22">
<a class="reference internal image-reference" href="_images/ExpsetupB16.png"><img alt="_images/ExpsetupB16.png" src="_images/ExpsetupB16.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">A typical setup for the speckle wavefront sensing experiment.
This picture was taken at the Test beamline B16 at Diamond Light Source Ltd.</span><a class="headerlink" href="#id22" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The early technique developed is the conventional X-ray Speckle
Tracking (XST) method <a class="reference internal" href="#berujonprl" id="id3"><span>[BerujonPRL]</span></a>.
Only two images are required for this method.
In order to further improve the spatial resolution of the
data processing, the scan based techniques were proposed
<a class="reference internal" href="#berujonpra" id="id4"><span>[BerujonPRA]</span></a>, <a class="reference internal" href="#berujonoe" id="id5"><span>[BerujonOE]</span></a>.
They are referred as X-ray Speckle Scanning (XSS) techniques.
To trade off between the spatial resolution of the data processing
and the data acquisition time, X-ray Speckle Vector Tracking (XSVT)
was developed <a class="reference internal" href="#berujonzieglerpra" id="id6"><span>[BerujonZieglerPRA]</span></a>.</p>
<p>For a complete review of the theoretical and experimental part of
the speckle-based wavefront sensing techniques, please refere to
<a class="reference internal" href="#jsrtheory" id="id7"><span>[JSRTheory]</span></a> and <a class="reference internal" href="#jsrexperiment" id="id8"><span>[JSRExperiment]</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this package, we didn’t implement the 2D version
of XSS techniques as introduced in <a class="reference internal" href="#jsrtheory" id="id9"><span>[JSRTheory]</span></a> and <a class="reference internal" href="#jsrexperiment" id="id10"><span>[JSRExperiment]</span></a>,
taking the practical data acquisition time into consideration.
Thus, all the XSS-techniques used in this package correspond to the
1D scan of the XSS techniques.</p>
</div>
<p>In general, the speckle-based X-ray wavefront characterization
methods can be divided into <strong>two modes</strong>. They depend on whether the
reference beam is available or not.</p>
<p>If the tested optical element is a weakly-focusing object,
such as single CRL or even a planar reflecting mirror,
the incident beam without the tested optical element can be
treated as a reference beam.
The speckle patterns acquired with or without the tested optical
element are comparable with each other.
This mode corresponds to the ‘differetial mode’
discussed in <a class="reference internal" href="#jsrtheory" id="id11"><span>[JSRTheory]</span></a>.
In this documentation, we call this mode with the suffix
<strong>‘with reference beam’</strong>.</p>
<p>For the strong-focusing optics, such as curved mirror,
the speckle patterns can be very different with and without
the tested optics in the beam.
In this case, no reference beam is available.
The speckle patterns to be compared come from the same data set
in which the tested optics are always in the beam.
Here, in this documentation, we call this mode with the prefix
<strong>‘self-reference’</strong>.</p>
<p>Regardless of the characterization modes, the various techniques
all trace the shift of the speckle pattern.
However, these shifts are caused by different physcial process.
In other words, different modes represent different
physcial quantities directly characterized.</p>
<p>In brief, when the reference beam is available,
the speckle pattern shift is caused by the
first derivative, i.e., the slope of the measured wavefront.
Otherwise, when in self-reference mode,
the speckle pattern shift is caused by the
second derivative, i.e., the curvature of the measured wavefront.</p>
<p>Another variation for the data acquisation is the position of
diffuser. It can be placed in the upstream or downstream
of the tested optic, depending on the type of it.
In general, the diffuser can be placed in either the upstream or
the downstream of the tested optic if it is a weakly focusing optic.
Otherwise, the diffuser is usually placed in the downstream of the
optic.</p>
<p>The following table gives a summary of the speckle-based techniques
included in this package. For the detailed description of the principle
of each technique, please see the following sections.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Technique</p></th>
<th class="head"><p>Number of images</p></th>
<th class="head"><p>Physical quantity directly measured</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Conventional XST <a class="footnote-reference brackets" href="#id13" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
<td><p>1 image for both reference and
sample dataset.</p></td>
<td><p>Wavefront slope</p></td>
</tr>
<tr class="row-odd"><td><p>Self-reference XST</p></td>
<td><p>2 images for reference dataset.</p></td>
<td><p>Wavefront curvature</p></td>
</tr>
<tr class="row-even"><td><p>XSS with reference
beam</p></td>
<td><p>2 datasets, for reference and sample each.
The number of images in one dataset equals to
the number of scans.</p></td>
<td><p>Wavefront slope</p></td>
</tr>
<tr class="row-odd"><td><p>Self-reference XSS</p></td>
<td><p>1 dataset, for sample images.
The number of images equals to
the number of scans.</p></td>
<td><p>Wavefront curvature</p></td>
</tr>
<tr class="row-even"><td><p>XSVT</p></td>
<td><p>2 datasets, for reference and sample each.
The number of images equals to
the number of random scans.</p></td>
<td><p>Wavefront slope</p></td>
</tr>
</tbody>
</table>
<aside class="footnote brackets" id="id13" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id12">1</a><span class="fn-bracket">]</span></span>
<p>The conventional XST technique in this package refers to the case with and without tested optic in the beam.
It is the ‘differential mode’ in <a class="reference internal" href="#jsrtheory" id="id14"><span>[JSRTheory]</span></a>. However, the data processing procedure for the ‘absolute mode’
is almost the same.</p>
</aside>
<div role="list" class="citation-list">
<div class="citation" id="berujonprl" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>BerujonPRL<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id3">2</a>,<a role="doc-backlink" href="#id15">3</a>)</span>
<p>Berujon S, Ziegler E, Cerbino R, Peverini L.
Two-dimensional x-ray beam phase sensing.
Phys Rev Lett. 2012 Apr 13;108(15):158102.
<a class="reference external" href="https://doi.org/10.1103/PhysRevLett.108.158102">https://doi.org/10.1103/PhysRevLett.108.158102</a></p>
</div>
<div class="citation" id="morganapl" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">MorganAPL</a><span class="fn-bracket">]</span></span>
<p>Kaye S. Morgan, David M. Paganin, Karen K. W. Siu
X-ray phase imaging with a paper analyzer.
Appl. Phys. Lett. 19 March 2012; 100 (12): 124102.
<a class="reference external" href="https://doi.org/10.1063/1.3694918">https://doi.org/10.1063/1.3694918</a></p>
</div>
<div class="citation" id="berujonpra" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">BerujonPRA</a><span class="fn-bracket">]</span></span>
<p>Berujon, S., Wang, H., &amp; Sawhney, K.J.
(2012). X-ray multimodal imaging using a random-phase object.
Physical Review A, 86, 063813.
<a class="reference external" href="https://doi.org/10.1103/PhysRevA.86.063813">https://doi.org/10.1103/PhysRevA.86.063813</a></p>
</div>
<div class="citation" id="berujonoe" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">BerujonOE</a><span class="fn-bracket">]</span></span>
<p>Berujon, S., Wang, H., Alcock, S.G., &amp; Sawhney, K.J.
(2014). At-wavelength metrology of hard X-ray mirror using near field speckle.
Optics express, 22 6, 6438-46.
<a class="reference external" href="https://doi.org/10.1364/OE.22.006438">https://doi.org/10.1364/OE.22.006438</a></p>
</div>
<div class="citation" id="berujonzieglerpra" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>BerujonZieglerPRA<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id6">1</a>,<a role="doc-backlink" href="#id19">2</a>)</span>
<p>Berujon, S., &amp; Ziegler, E. (2017).
Near-field speckle-scanning-based X-ray tomography.
Physical Review A, 95.
<a class="reference external" href="https://doi.org/10.1103/PhysRevA.95.063822">https://doi.org/10.1103/PhysRevA.95.063822</a></p>
</div>
<div class="citation" id="jsrtheory" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>JSRTheory<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id7">1</a>,<a role="doc-backlink" href="#id9">2</a>,<a role="doc-backlink" href="#id11">3</a>,<a role="doc-backlink" href="#id14">4</a>,<a role="doc-backlink" href="#id20">5</a>)</span>
<p>Berujon, S., Cojocaru, R., Piault, P., Celestre, R., Roth, T., Barrett, R. &amp; Ziegler, E. (2020).
X-ray optics and beam characterization using random modulation: theory
J. Synchrotron Rad. 27, 284-292.
<a class="reference external" href="https://doi.org/10.1107/S1600577520000491">https://doi.org/10.1107/S1600577520000491</a></p>
</div>
<div class="citation" id="jsrexperiment" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>JSRExperiment<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id8">1</a>,<a role="doc-backlink" href="#id10">2</a>,<a role="doc-backlink" href="#id21">3</a>)</span>
<p>Berujon, S., Cojocaru, R., Piault, P., Celestre, R., Roth, T., Barrett, R. &amp; Ziegler, E. (2020).
X-ray optics and beam characterization using random modulation: experiments
J. Synchrotron Rad. 27, 293-304.
<a class="reference external" href="https://doi.org/10.1107/S1600577520000508">https://doi.org/10.1107/S1600577520000508</a></p>
</div>
</div>
<p>This page only introduces the basic principle of each technique.
For the actual implementation of these methods in the code,
please refer to the <a class="reference internal" href="userguide.html"><span class="doc">user guide</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this package, we assume the incident beam is from the quasi-parallel
beam from the synchrotron radiation source going through the beamline
without any other optics except one monochrometer.
If the incident is a quasi-spherical wave, some modifications are needed
for some techniques.</p>
</div>
<section id="conventional-x-ray-speckle-tracking-xst-technique-with-reference-beam">
<span id="prinxstrefer"></span><h2>Conventional X-ray Speckle Tracking (XST) technique with reference beam<a class="headerlink" href="#conventional-x-ray-speckle-tracking-xst-technique-with-reference-beam" title="Permalink to this heading"></a></h2>
<p>The conventional XST technique with reference beam was developed at the
early stage of the <em>in-situ</em> at-wavelength characterization of the X-ray
wavefront using speckle pattern <a class="reference internal" href="#berujonprl" id="id15"><span>[BerujonPRL]</span></a>.
It is inspired by the popular digital imaging correlation analysis which
is commonly used in visible light metrology and mechanical
engineering applications. As the name suggests,
this technique is used when a reference beam is available.</p>
<p>If the speckle pattern generated by the incident
beam without the tested optical element in the
beam is trackable to the speckle pattern generated by the
tested optical element, we can call the incident beam as a reference beam.
Obviously, the reference beam only exist when the tested optical element is planar
or weak-focusing. Otherwise, the speckle pattern would change dramatically
that the speckle pattern generated by the tested optical element is not comparable
to that by the incident beam.</p>
<p>The following figure shows the experiment
setup for this technique.</p>
<figure class="align-default" id="id23">
<a class="reference internal image-reference" href="_images/conXST_principle.png"><img alt="_images/conXST_principle.png" src="_images/conXST_principle.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-text">The experiment layout for the conventional X-ray speckle tracking
technique with reference beam.</span><a class="headerlink" href="#id23" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>During the experiment, the tested optical element is moved away from the X-ray
beam to acquire the reference speckle pattern. Then it is moved in the beam
to acquire another speckle pattern image.</p>
<p>Only two images are required for this technique.
Subregion of the speckle pattern from the sample image is cross-correlated
with the speckle pattern from the reference image.
After that, the shift of the speckle pattern in vertical and horizontal directions
can be acquired.</p>
<p>The physical quantity directly obtained from this method is the wavefront slope.
We use <span class="math notranslate nohighlight">\(ix\)</span> and <span class="math notranslate nohighlight">\(iy\)</span> to represnt the shift in the cooresponding direction.
The pixel size of the detector,
and the wavefront slopes in x and y directions can be represented by <span class="math notranslate nohighlight">\(p\)</span>,
<span class="math notranslate nohighlight">\(\alpha_x\)</span>
and <span class="math notranslate nohighlight">\(\alpha_y\)</span>, respectively.
<span class="math notranslate nohighlight">\(D\)</span> represents the distance between the diffuser and the detector plane
if the diffuser is placed in the downstream of the tested optic.
Otherwise, it is the distance between the centre of the tested optic and the
detector plane. <span class="math notranslate nohighlight">\(W\)</span> represents the equiphase surface.</p>
<p>The following equations satisfy:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\alpha_x = \frac{\partial W}{\partial x} = \frac{ix \times p}{D}\\\alpha_y = \frac{\partial W}{\partial y} = \frac{iy \times p}{D}\end{aligned}\end{align} \]</div>
<p>Note in the above equations, <span class="math notranslate nohighlight">\(\alpha_x\)</span> and <span class="math notranslate nohighlight">\(\alpha_y\)</span> are the slopes, i.e.,
the first derivatives of the wavefront.</p>
</section>
<section id="self-reference-x-ray-speckle-tracking-xst-technique">
<span id="prinxstself"></span><h2>Self-reference X-ray Speckle Tracking (XST) technique<a class="headerlink" href="#self-reference-x-ray-speckle-tracking-xst-technique" title="Permalink to this heading"></a></h2>
<p>No reference beam exists for this type of tracking method.
As a result, the images to be tracked are both from sample images.</p>
<p>This technique also requires two images only.
They are acquired at two different diffuser positions.</p>
<p>The following figure shows the experiment
setup for this technique.</p>
<figure class="align-default" id="id24">
<a class="reference internal image-reference" href="_images/conXST3_principle.png"><img alt="_images/conXST3_principle.png" src="_images/conXST3_principle.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-text">The experiment layout for the self-reference
X-ray speckle tracking
technique.</span><a class="headerlink" href="#id24" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The self-reference XST technique may look ostensibly like the above mentioned
XST technique with reference beam.
However, the physical quantities obtained directly from the speckle pattern shifts are
very much different <a class="reference internal" href="#huxstoe" id="id16"><span>[HuXSTOE]</span></a>.</p>
<p>We use <span class="math notranslate nohighlight">\(s_x\)</span> and <span class="math notranslate nohighlight">\(s_y\)</span> to represent the displacement in two directions for the pizeo
at two different positions, <span class="math notranslate nohighlight">\(ix\)</span> and <span class="math notranslate nohighlight">\(iy\)</span> to represent the shifts of the
speckle pattern in the cooresponding direction.
<span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(\alpha_x\)</span> and <span class="math notranslate nohighlight">\(\alpha_y\)</span> represent
the pixel size of the detector,
the wavefront slopes in x and y directions, respectively.
<span class="math notranslate nohighlight">\(D\)</span> represents the distance between the diffuser and the detector plane
if the diffuser is placed in the downstream of the tested optic.
Otherwise, it is the distance between the centre of the tested optic and the
detector plane. <span class="math notranslate nohighlight">\(W\)</span> represents the equiphase surface.</p>
<p>We have the following equations:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\frac{1}{R_x} \approx \frac{\partial^{2}W}{\partial x^2} = \frac{1}{D} - \frac{s_x}{i_x \times p \times D}\\\frac{1}{R_y} \approx \frac{\partial^{2}W}{\partial y^2} = \frac{1}{D} - \frac{s_y}{i_y \times p \times D}\end{aligned}\end{align} \]</div>
<p>Note in the above equations, <span class="math notranslate nohighlight">\(R_x\)</span> and <span class="math notranslate nohighlight">\(R_y\)</span> are the curvatures, i.e.,
the second derivative of the wavefront.</p>
<p>See the examples for the applications of the <a class="reference internal" href="example.html#expkbalign"><span class="std std-ref">1D</span></a> and <a class="reference internal" href="example.html#expxssvsxst"><span class="std std-ref">2D</span></a> self-reference
XST technique.</p>
<div role="list" class="citation-list">
<div class="citation" id="huxstoe" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id16">HuXSTOE</a><span class="fn-bracket">]</span></span>
<p>Hu, L., Wang, H., Fox, O., &amp; Sawhney, K. (2022).
Fast wavefront sensing for X-ray optics with an alternating speckle tracking technique.
Opt. Exp., 30(18), 33259-33273.
<a class="reference external" href="https://doi.org/10.1364/OE.460163">https://doi.org/10.1364/OE.460163</a></p>
</div>
</div>
</section>
<section id="x-ray-speckle-scanning-xss-technique-with-reference-beam">
<span id="prinxssrefer"></span><h2>X-ray Speckle Scanning (XSS) technique with reference beam<a class="headerlink" href="#x-ray-speckle-scanning-xss-technique-with-reference-beam" title="Permalink to this heading"></a></h2>
<p>The X-ray speckle scanning method was developed to further
improve the spatial resolution of the speckle-based
wavefront sensing techniques.
The XSS techniques enable the analysis of the wavefront
pixel-by-pixel along the scan direction,
making it suitable for at-wavelength measurements with
high sensitivity and precision.</p>
<p>Like the conventional XST-like techniques,
the XSS-like techniques have two modes, depending on
whether the reference beam is available.</p>
<p>The following figure shows the data acquisition process
of the XSS technique with reference beam <a class="reference internal" href="#huxssjsr" id="id17"><span>[HuXSSJSR]</span></a>.
Note that compared to the above XST-like techniques,
the diffuser is scanned.</p>
<figure class="align-default" id="id25">
<a class="reference internal image-reference" href="_images/referXSS_principle.png"><img alt="_images/referXSS_principle.png" src="_images/referXSS_principle.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-text">The experiment layout for the X-ray speckle scanning
technique with reference beam.</span><a class="headerlink" href="#id25" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The data is processed pixel-wisely in the scan direction.
During the data processing procedure,
sub-regions of the raw images in each stack was extracted
and stitched together to form a new image.
Two new images were thereby generated from the two image stacks.
They are then cross-correlated.
As a result, the tracked pattern shifts are in
the unit of the scan step.</p>
<p>Like the conventional XST method with reference beam,
the phsycial quantity directly derived from the tracked
speckle pattern shift is the wavefront slope,
i.e., the first derivative of the wavefront.</p>
<p>The following equations satisfy:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\alpha_x = \frac{\partial W}{\partial x} = \frac{ix \times s_x}{D}\\\alpha_y = \frac{\partial W}{\partial y} = \frac{iy \times s_y}{D}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_x\)</span>, <span class="math notranslate nohighlight">\(\alpha_y\)</span> are the slopes of the wavefront,
<span class="math notranslate nohighlight">\(ix\)</span> and <span class="math notranslate nohighlight">\(iy\)</span> are the tracked shifts of the speckle pattern
in x and y directions, <span class="math notranslate nohighlight">\(s_x\)</span> and <span class="math notranslate nohighlight">\(s_y\)</span> are the scan steps in
two directions.
<span class="math notranslate nohighlight">\(D\)</span> represents the distance between the diffuser and the detector plane
if the diffuser is placed in the downstream of the tested optic.
Otherwise, it is the distance between the centre of the tested optic and the
detector plane. <span class="math notranslate nohighlight">\(W\)</span> represents the equiphase surface.</p>
<p>This technique has been shown in the <a class="reference internal" href="example.html#expplane"><span class="std std-ref">example</span></a>.</p>
<div role="list" class="citation-list">
<div class="citation" id="huxssjsr" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id17">HuXSSJSR</a><span class="fn-bracket">]</span></span>
<p>Hu, L., Wang, H., Fox, O., &amp; Sawhney, K. (2022).
Two-dimensional speckle technique for slope error measurements of
weakly focusing reflective X-ray optics.
J. Synchrotron Rad. 29(6).
<a class="reference external" href="https://doi.org/10.1107/S160057752200916X">https://doi.org/10.1107/S160057752200916X</a></p>
</div>
</div>
</section>
<section id="self-reference-x-ray-speckle-scanning-xss-technique">
<span id="prinxssself"></span><h2>Self-reference X-ray Speckle Scanning (XSS) technique<a class="headerlink" href="#self-reference-x-ray-speckle-scanning-xss-technique" title="Permalink to this heading"></a></h2>
<p>As the name indicates, when there is no reference beam,
this technique is used.</p>
<p>The image data are acquired during the scan of the diffuser in
either x or y direction <a class="reference internal" href="#wangxssoe" id="id18"><span>[WangXSSOE]</span></a>. For this technique,
only one image stack is acquired.
It is obtained with the tested optical element in the beam.</p>
<p>The following figure shows the data acquisition procedure for
the self-reference XSS technique.</p>
<figure class="align-default" id="id26">
<a class="reference internal image-reference" href="_images/selfXSS_principle.png"><img alt="_images/selfXSS_principle.png" src="_images/selfXSS_principle.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-text">The experiment layout for the self-reference
X-ray speckle scanning technique.</span><a class="headerlink" href="#id26" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Like the self-reference conventional XST method,
the physical quantity directly derived from the tracked
speckle pattern shift for this technique
is the wavefront slope, i.e., the second derivative
of the wavefront.</p>
<p>We have the following equations:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\frac{1}{R_x} \approx \frac{\partial^{2}W}{\partial x^2} = \frac{1}{D} - \frac{i_x \times s_x}{(j-i) \times p \times D}\\\frac{1}{R_y} \approx \frac{\partial^{2}W}{\partial y^2} = \frac{1}{D} - \frac{i_y \times s_y}{(j-i) \times p \times D}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(R_x\)</span> and <span class="math notranslate nohighlight">\(R_y\)</span> are the curvatures of the wavefront.
They are the second derivatives of the wavefront in the
horizontal and vertical directions.
<span class="math notranslate nohighlight">\(ix\)</span> and <span class="math notranslate nohighlight">\(iy\)</span> are the tracked shifts of the speckle pattern,
<span class="math notranslate nohighlight">\(s_x\)</span> and <span class="math notranslate nohighlight">\(s_y\)</span> are the scan steps,
<span class="math notranslate nohighlight">\(p\)</span> is the pixel size of the detector,
<span class="math notranslate nohighlight">\(D\)</span> represents the distance between the diffuser and the detector plane
if the diffuser is placed in the downstream of the tested optic.
Otherwise, it is the distance between the centre of the tested optic and the
detector plane. <span class="math notranslate nohighlight">\(W\)</span> represents the equiphase surface.</p>
<p>Please see <a class="reference internal" href="example.html#exp2ndderiv"><span class="std std-ref">this example</span></a> for the use of self-reference XSS technique to
measure wavefront local curvature after a plane mirror.</p>
<div role="list" class="citation-list">
<div class="citation" id="wangxssoe" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">WangXSSOE</a><span class="fn-bracket">]</span></span>
<p>Wang H, Sutter J, Sawhney K.
Advanced in situ metrology for x-ray beam shaping with super precision.
Opt Express 2015, 23(2): 1605-1614.
<a class="reference external" href="https://doi.org/10.1364/OE.23.001605">https://doi.org/10.1364/OE.23.001605</a></p>
</div>
</div>
</section>
<section id="x-ray-speckle-vector-tracking-xsvt-technique">
<span id="prinxsvtrefer"></span><h2>X-ray Speckle Vector Tracking (XSVT) technique<a class="headerlink" href="#x-ray-speckle-vector-tracking-xsvt-technique" title="Permalink to this heading"></a></h2>
<p>The XSS technique enables pixel-wise data analysis along the scan direction,
whereas the XST technique requires at least several speckle grains to be
included in the subregion which is to be tracked.
On the other hand, the XSS techinque requires a number of scans
in order to obtain reliable tracking results,
while the XST technique only needs two images.</p>
<p>The X-ray speckle vector tracking was proposed <a class="reference internal" href="#berujonzieglerpra" id="id19"><span>[BerujonZieglerPRA]</span></a> to
trade off between the number of images to be obtained
and the spatial resolution achieved for the data processing.</p>
<p>For XSVT method, the reference and sample images are taken at the same
piezo positions. The piezo are moving randomly during the
data acquisition.</p>
<figure class="align-default" id="id27">
<a class="reference internal image-reference" href="_images/XSVT_principle.png"><img alt="_images/XSVT_principle.png" src="_images/XSVT_principle.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-text">The experiment layout for the X-ray speckle vector tracking technique.</span><a class="headerlink" href="#id27" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Like the XSS technique with reference beam, two datasets will be obtained
in the end. The data processing procedure for XSVT also resembles the XSS
technique. A new image will be formed by extracting the data row(column) by
row(column) and stiched together along the “random scan direction”.
However, due to the random scan of the piezo, the tracked speckle pattern
shift in the scan direction has no clear physical meaning and is dropped out.
The shift in the orthogonal direction is in the unit of detector pixel size
other than the scan step size as in the XSS technique.</p>
<p>It should be noted that XSVT method cannot be used in the self-reference case
since the scan direction is random rather than along x or y
direction. So the tracked speckle pattern shift from XSVT method represents
the slope, i.e., the first derivative of the measured wavefront.</p>
<p>As a result, we have the following equations:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\alpha_x = \frac{\partial W}{\partial x} = \frac{ix \times p}{D}\\\alpha_y = \frac{\partial W}{\partial y} = \frac{iy \times p}{D}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_x\)</span>, <span class="math notranslate nohighlight">\(\alpha_y\)</span> are the slopes of the wavefront,
<span class="math notranslate nohighlight">\(ix\)</span> and <span class="math notranslate nohighlight">\(iy\)</span> are the tracked shifts of the speckle pattern
in x and y directions, <span class="math notranslate nohighlight">\(p\)</span> is the pixel size of the detector,
<span class="math notranslate nohighlight">\(D\)</span> represents the distance between the diffuser and the detector plane
if the diffuser is placed in the downstream of the tested optic.
Otherwise, it is the distance between the centre of the tested optic and the
detector plane. <span class="math notranslate nohighlight">\(W\)</span> represents the equiphase surface.</p>
</section>
<section id="hartmann-like-data-processing-method">
<span id="prinhart"></span><h2>Hartmann-like data processing method<a class="headerlink" href="#hartmann-like-data-processing-method" title="Permalink to this heading"></a></h2>
</section>
<section id="other-x-ray-speckle-based-techniques">
<span id="prinother"></span><h2>Other X-ray Speckle-based techniques<a class="headerlink" href="#other-x-ray-speckle-based-techniques" title="Permalink to this heading"></a></h2>
<p>Due to special experimental considerations, all the techniques described in the above keep
the detector fixed. As a result,
all the so called “absolute mode” sepckle-based techniques (see <a class="reference internal" href="#jsrtheory" id="id20"><span>[JSRTheory]</span></a> and <a class="reference internal" href="#jsrexperiment" id="id21"><span>[JSRExperiment]</span></a>)
are not inculded in this python package ostensibly.
However, the data processing procedure for these “absolute mode” techniques
is the same as their corresponding techniques in the above.</p>
<p>For instance, the “absolute mode” XST technique is equivalent to the
<a class="reference internal" href="#prinxstrefer"><span class="std std-ref">conventional XST with reference beam</span></a>, only to
replace <span class="math notranslate nohighlight">\(D\)</span> the distance between the diffuser and the detector plane
to the detector moving distance. Similarly,
the “absolute mode” XSVT technique is equivalent to the
<a class="reference internal" href="#prinxsvtrefer"><span class="std std-ref">XSVT technique</span></a>. Again, we need only to
replace <span class="math notranslate nohighlight">\(D\)</span> the distance between the diffuser and the detector plane
to the detector moving distance.</p>
<p>For any other novel techniques, finding the equivalent methods in this package
is left to the discretion of the users.</p>
<p><strong>All the techniques described in the above have been implemented in the</strong>
<a class="reference internal" href="spexwavepy.html#spexwavepy.trackfun.Tracking" title="spexwavepy.trackfun.Tracking"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tracking</span></code></a> <strong>class.</strong>
<strong>Please refer to the</strong> <a class="reference internal" href="userguide.html#usetrack"><span class="std std-ref">User guide</span></a> <strong>for the detailed
implemention in the code.</strong></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">The speckle-based wavefront sensing techniques</a><ul>
<li><a class="reference internal" href="#conventional-x-ray-speckle-tracking-xst-technique-with-reference-beam">Conventional X-ray Speckle Tracking (XST) technique with reference beam</a></li>
<li><a class="reference internal" href="#self-reference-x-ray-speckle-tracking-xst-technique">Self-reference X-ray Speckle Tracking (XST) technique</a></li>
<li><a class="reference internal" href="#x-ray-speckle-scanning-xss-technique-with-reference-beam">X-ray Speckle Scanning (XSS) technique with reference beam</a></li>
<li><a class="reference internal" href="#self-reference-x-ray-speckle-scanning-xss-technique">Self-reference X-ray Speckle Scanning (XSS) technique</a></li>
<li><a class="reference internal" href="#x-ray-speckle-vector-tracking-xsvt-technique">X-ray Speckle Vector Tracking (XSVT) technique</a></li>
<li><a class="reference internal" href="#hartmann-like-data-processing-method">Hartmann-like data processing method</a></li>
<li><a class="reference internal" href="#other-x-ray-speckle-based-techniques">Other X-ray Speckle-based techniques</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">spexwavepy</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="getstart.html"
                          title="next chapter">Getting started</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="getstart.html" title="Getting started"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="spexwavepy"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">spexwavepy 1.0.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">The speckle-based wavefront sensing techniques</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2024, Lingfei Hu, Hongchang Wang.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>